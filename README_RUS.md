# Автозаполнение документов

Этот скрипт предназначен для автоматического заполнения шаблонов документов Word на основе данных из таблицы Excel.

## Описание

Скрипт `auto_fill_documents.py` представляет собой программу на Python, которая обеспечивает автоматическое заполнение шаблонов документов Word на основе данных, предоставленных в формате Excel. Он создан с использованием различных библиотек и модулей Python, таких как `openpyxl` для работы с Excel, `docxtpl` для заполнения шаблонов Word, а также `Tkinter` для создания пользовательского интерфейса.

## Использование

1. Запустите скрипт `auto_fill_documents.py`.
2. Выберите файл шаблона Word, файл Excel с данными и папку для сохранения результатов.
3. Нажмите кнопку "Продолжить", чтобы начать заполнение документов.
4. После завершения процесса создания документов вы увидите соответствующее уведомление.

## Функциональность

- **Выбор файлов и папок**: пользователь может выбрать файлы шаблонов Word и Excel с помощью соответствующих кнопок.
- **Заполнение документов**: программа заполняет шаблоны Word данными из таблицы Excel, создавая новые документы.
- **Сохранение результатов**: сгенерированные документы сохраняются в выбранную пользователем папку.
- **Пользовательский интерфейс**: программа предоставляет простой и интуитивно понятный пользовательский интерфейс, который позволяет легко управлять процессом заполнения документов.

## Требования

Для запуска этого скрипта необходимо иметь установленные следующие библиотеки Python:

- `openpyxl`
- `docxtpl`
- `docx2pdf`
- `docx2txt`
- `Tkinter`

## Встроенные функции

В скрипте предусмотрены следующие встроенные функции:

- **close_program()**: Закрывает программу.
- **restart_program()**: Перезапускает программу.
- **generate_unique_suffix(length)**: Генерирует уникальный суффикс заданной длины.
- **parse_template(template_path)**: Парсит переменные из шаблона Word.
- **select_template_file()**: Открывает диалоговое окно для выбора файла шаблона Word.
- **select_excel_file()**: Открывает диалоговое окно для выбора файла Excel с данными.
- **select_save_folder()**: Открывает диалоговое окно для выбора папки для сохранения файлов.
- **open_folder()**: Открывает папку с собранными файлами.
- **compare_headers_and_variables(header_row, template_variables)**: Сравнивает заголовки Excel и переменные шаблона.
- **show_header_and_variable_selection_ui(root, header_row, template_variables)**: Отображает интерфейс выбора заголовков и переменных.
- **show_differences_ui(root, header_row, template_variables)**: Отображает интерфейс различий между заголовками и переменными.
- **set_label_width(label, max_width)**: Устанавливает ширину метки.
- **select_column(root, header_row, template_variables)**: Отображает интерфейс выбора столбца Excel.
- **show_success_or_report_window(root)**: Отображает окно успешного выполнения или отчета об ошибке.
- **clear_window(root)**: Очищает основное окно.
- **create_doc(root, akt_list, header_row, column_index, column_name, convert_to_pdf=True, delete_docx=True)**: Создает документ.
- **excel_read(root, path_file)**: Читает данные из файла Excel.
- **on_closing(root)**: Обрабатывает закрытие окна.
- **show_developer_info()**: Отображает информацию о разработчике.

## Пример использования переменных в шаблоне Word

```bash
Уважаемый {{ Имя }},

Мы рады сообщить вам, что ваш заказ №{{ Номер заказа }} был успешно обработан.
```

В этом примере `{{ Имя }}` и `{{ Номер заказа }}` - это переменные, которые будут заменены на конкретные значения из файла Excel.

## Важное примечание

Программа предполагает, что данные в таблице Excel имеют определенную структуру, с соответствующими заголовками столбцов, которые совпадают с переменными в шаблоне Word.

## Установка выполняемого файла

### Метод 1: Используя PyInstaller

1. **Установка PyInstaller**: Если вы еще не установили PyInstaller, сделайте это с помощью pip:
   ```bash
   pip install pyinstalle

2. **Создание выполняемого файла**: Перейдите в каталог, содержащий ваш скрипт Python (auto_fill_documents.py), с помощью командной строки, затем выполните PyInstaller:
    ```bash
    pyinstaller --onefile auto_fill_documents.py

3. **Нахождение выполняемого файла**: После завершения процесса сборки PyInstaller вы найдете его в каталоге dist внутри каталога, где находится ваш скрипт.

4. **Запуск выполняемого файла**: Дважды щелкните по созданному выполняемому файлу (auto_fill_documents.exe), чтобы запустить программу.

### Метод 2: Используя Auto-py-to-exe

1. **Установка Auto-py-to-exe**: Если вы еще не установили Auto-py-to-exe, сделайте это с помощью pip:
    ```bash
    pip install auto-py-to-exe

2. **Запуск Auto-py-to-exe**: Запустите Auto-py-to-exe, введите команду auto-py-to-exe в командной строке или терминале.

3. **Настройка параметров**: В окне Auto-py-to-exe укажите путь к вашему скрипту Python (auto_fill_documents.py), выберите нужные параметры сборки, такие как один файл или несколько файлов, и нажмите кнопку "Convert .py to .exe".

4. **Нахождение выполняемого файла**: После завершения процесса конвертации Auto-py-to-exe создаст выполняемый файл в указанном вами местоположении.

5. **Запуск выполняемого файла**: Дважды щелкните по созданному выполняемому файлу, чтобы запустить программу.


## Автор

Этот скрипт был разработан [R V](https://github.com/vok32).